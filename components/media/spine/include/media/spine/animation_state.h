#ifndef MEDIALIB_SPINE_ANIMATION_STATE_HEADER
#define MEDIALIB_SPINE_ANIMATION_STATE_HEADER

#include <media/spine/track_entry.h>

namespace media
{

namespace spine
{

//forward declarations
class IAnimationState;
class Wrappers;

///////////////////////////////////////////////////////////////////////////////////////////////////
///Spine animation state instance
///////////////////////////////////////////////////////////////////////////////////////////////////
class AnimationState
{
  friend class Wrappers;
  public:
///////////////////////////////////////////////////////////////////////////////////////////////////
///Constructors / destructor / assignment
///////////////////////////////////////////////////////////////////////////////////////////////////
    AnimationState (const AnimationState&);
    ~AnimationState ();

    AnimationState& operator = (const AnimationState&);

///////////////////////////////////////////////////////////////////////////////////////////////////
///Work with tracks
///////////////////////////////////////////////////////////////////////////////////////////////////
    TrackEntry* SetAnimation          (unsigned int track, const char* animation, bool looped);
    TrackEntry* SetEmptyAnimation     (unsigned int track, float mix_duration);
    TrackEntry* SetEmptyAnimations    (float mix_duration);
    TrackEntry* EnqueueAnimation      (unsigned int track, const char* animation, bool looped, float delay);
    TrackEntry* EnqueueEmptyAnimation (unsigned int track, float mix_duration, float delay);
    void        ClearTracks           ();
    void        ClearTrack            (unsigned int track);
    TrackEntry* CurrentTrackEntry     (unsigned int track);

///////////////////////////////////////////////////////////////////////////////////////////////////
///Register for animation events
///////////////////////////////////////////////////////////////////////////////////////////////////
    xtl::connection RegisterEventHandler (AnimationEvent event, const AnimationEventHandler& handler) const;
    xtl::connection RegisterEventHandler (const UserEventHandler& handler) const;

///////////////////////////////////////////////////////////////////////////////////////////////////
///Update (only positive dt allowed)
///////////////////////////////////////////////////////////////////////////////////////////////////
    void Update (float dt);

///////////////////////////////////////////////////////////////////////////////////////////////////
///Swap
///////////////////////////////////////////////////////////////////////////////////////////////////
    void Swap (AnimationState&);

  protected:
    AnimationState (IAnimationState*);

  private:
    IAnimationState* impl;
};

///////////////////////////////////////////////////////////////////////////////////////////////////
///Swap
///////////////////////////////////////////////////////////////////////////////////////////////////
void swap (AnimationState&, AnimationState&);

}

}

#endif
