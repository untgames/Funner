#ifndef RENDER_SCENE_SERVER_PARTICLE_SYSTEM_MANAGER_SHARED_HEADER
#define RENDER_SCENE_SERVER_PARTICLE_SYSTEM_MANAGER_SHARED_HEADER

#include <stl/auto_ptr.h>

#include <shared/render_manager.h>

namespace media
{

namespace particles
{

//forward declarations
class ParticleSystem;

}

}

namespace render
{

namespace scene
{

namespace server
{

//forward declarations
struct ParticleSystemRenderingTempCache;

typedef xtl::shared_ptr<ParticleSystemRenderingTempCache> ParticleSystemRenderingTempCachePtr;

///////////////////////////////////////////////////////////////////////////////////////////////////
///Particle system manager
///////////////////////////////////////////////////////////////////////////////////////////////////
class ParticleSystemManager
{
  public:
///////////////////////////////////////////////////////////////////////////////////////////////////
///Constructor / destructor
///////////////////////////////////////////////////////////////////////////////////////////////////
    ParticleSystemManager  ();
    ~ParticleSystemManager ();

///////////////////////////////////////////////////////////////////////////////////////////////////
///Create particle system
///////////////////////////////////////////////////////////////////////////////////////////////////
    media::particles::ParticleSystem CreateParticleSystem (const char* particle_system_id);

///////////////////////////////////////////////////////////////////////////////////////////////////
///Load / unload particle systems
///////////////////////////////////////////////////////////////////////////////////////////////////
    void Load   (const char* name);
    void Unload (const char* name);

///////////////////////////////////////////////////////////////////////////////////////////////////
///Check if given resource name can be loaded by this manager
///////////////////////////////////////////////////////////////////////////////////////////////////
    bool IsSupportedResource (const char* name);

///////////////////////////////////////////////////////////////////////////////////////////////////
///Particle system rendering cache
///////////////////////////////////////////////////////////////////////////////////////////////////
    void                                       SetParticleSystemRenderingTempCache (const ParticleSystemRenderingTempCachePtr&);
    const ParticleSystemRenderingTempCachePtr& ParticleSystemRenderingTempCache    () const;

  private:
    ParticleSystemManager (const ParticleSystemManager&); //no impl
    ParticleSystemManager& operator = (const ParticleSystemManager&); //no impl

  private:
    struct Impl;
    stl::auto_ptr<Impl> impl;
};

}

}

}

#endif
